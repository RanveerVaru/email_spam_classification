services:
  - name: spam-backend
    type: web
    root: spam-backend
    env: python
    buildCommand: |
      pip install -r requirements.txt
      python - <<'PY'
import nltk
for pkg in ("punkt","stopwords"):
    try:
        nltk.data.find(f"tokenizers/{pkg}" if pkg=="punkt" else f"corpora/{pkg}")
    except LookupError:
        nltk.download(pkg)
print("NLTK ready")
PY
    startCommand: uvicorn app:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: 3.12.0

  - name: spam-frontend
    type: static
    root: spam-frontend
    buildCommand: yarn && yarn build
    staticPublishPath: dist
    envVars:
      - key: VITE_API_URL
        value: https://spam-backend.onrender.com
